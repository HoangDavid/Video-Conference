syntax="proto3";

package SFU;

option go_package="api/proto/";

enum SdpType {
    OFFER = 0;
    ANSWER = 1;
}

enum ActionType {
    JOIN = 0;
    LEAVE = 1;
    AUDIO = 2;
    VIDEO = 3;
    SUBTITLE = 4;
    DUB = 5;
}

// Event Type
enum EventType {
    START_ROOM_EVENT = 0;
    END_ROOM_EVENT = 1;
    JOIN_EVENT = 2;
    LEAVE_EVENT = 3;
    AUDIO_ON = 4;
    AUDIO_OFF = 5;
    VIDEO_ON = 6;
    VIDEO_OFF = 7;
}

// Peer Connection Type
enum PcType {
    PC_UNSPECIFIED = 0;
    PUB = 1;
    SUB = 2;
}

// Action
message Action {
    ActionType type = 1;
    bool toggle = 2;
}

// Session Description (SDP)
message Sdp {
    PcType pc = 1;
    SdpType type = 2;
    string sdp = 3;
}

//  Ice Candidate
message IceCandidate {
    PcType pc = 1;
    string candidate = 2;
    string sdp_mid = 3;
    uint32 sdp_mline_index = 4;
    string username_fragment = 5;
}

message PeerSignal {
    string room_id = 100;
    string peer_id = 101;

    oneof payload {
        Sdp sdp = 1;
        IceCandidate ice = 2;
        Action action = 3;
        EventType event = 4;
  }
}


service SFU {
    rpc Signal(stream PeerSignal) returns (stream PeerSignal);
}